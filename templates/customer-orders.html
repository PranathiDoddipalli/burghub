{% include "customer-head-active.html" %}

<section id="about">
    <div class="container">
        <h2 style="text-align: center; color: #eb8314; margin-top: 150px; margin-bottom: 20px">
            Current and older orders
        </h2>
        {% if orders_count > 0:%} {% for order in orders %}
        <section id="cart" class="section-p1">
            <table width="100%" style="margin-top: 50px">
                <thead>
                    <tr>
                        <td>Order Id : <span class="order-head">#{{getUpperIdFromOrderId(order['_id'])}}</span></td>

                        <td>Receive Method: <span class="order-head">{{order['delivery_type']}}</span></td>
                        <td>Order Date : <span class="order-head">{{order['order_date']}}</span></td>
                        <td>Total : <span class="order-head">{{order['amount']}}</span></td>
                        <td>
                            Status: {% if order['status'] == 'prepared' and order['delivery_type'] == 'pickup'%} Ready
                            to PickUp {%else%} {{order['status']}} {%endif%}
                        </td>
                        {%if order['status'] == 'rejected'%}
                        <td>Refund Status: {{order['refund_status']}}</td>
                        {%else%}
                        <td style="display: none"></td>
                        {%endif%}
                    </tr>
                </thead>

                <tbody>
                    <tr style="display: none">
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                    </tr>
                </tbody>
            </table>
            <table width="100%">
                <thead>
                    <tr>
                        <td>Item</td>
                        <td>Product</td>
                        <td>Item</td>
                        <td>Price / Unit</td>
                        <td>Quantity</td>
                        <td>Subtotal</td>
                    </tr>
                </thead>
                {% set items = order.get('items',[]) %}
                <tbody>
                    {%for item in items:%} {% set productInfo = item %} {% set product_id = productInfo['product_id'] %}
                    {% set product = get_product_by_product_id(product_id) %} {%if product:%}
                    <tr>
                        <td>{{loop.index}}</td>
                        <td><img src="../static/images/{{product['picture']}}" alt="" /></td>
                        <td>{{product['name']}}</td>
                        <td>${{product['price']}}</td>
                        <td>{{productInfo['quantity']}}</td>
                        <td>${{product['price'] | int * productInfo['quantity'] | int}}</td>
                    </tr>
                    {%endif%} {%endfor%}
                </tbody>
            </table>
        </section>
        {%endfor%} {% else %}
        <section style="display: flex; justify-content: center; height: 30vh; align-items: center">
            <h2>No Orders Placed yet!</h2>
        </section>
        {% endif %}
    </div>
</section>

{% include "footer.html" %}
